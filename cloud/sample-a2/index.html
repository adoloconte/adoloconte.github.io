<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://adoloconte.github.io/cloud/sample-a2/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.4.3, mkdocs-material-9.1.17"><title>Heading A2 - Ado Conte</title><link rel=stylesheet href=../../assets/stylesheets/main.26e3688c.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ecc896b0.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../stylesheets/extra.css><link rel=stylesheet href=../../stylesheets/links.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#heading-a2 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Ado Conte" class="md-header__button md-logo" aria-label="Ado Conte" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Ado Conte </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Heading A2 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/adoloconte/adoloconte.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> adoloconte/adoloconte.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Ado Conte" class="md-nav__button md-logo" aria-label="Ado Conte" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> Ado Conte </label> <div class=md-nav__source> <a href=https://github.com/adoloconte/adoloconte.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> adoloconte/adoloconte.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> About </a> </li> <li class=md-nav__item> <a href=../../paint/20230303/ class=md-nav__link> Paint </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../newsletter/0_newsletter_index/ >Newsletters</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Newsletters </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1> <div class="md-nav__link md-nav__link--index "> <a href=../../newsletter/2022/ >2022</a> <label for=__nav_3_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1> <div class="md-nav__link md-nav__link--index "> <a href=../../newsletter/2022_07/ >July of 2022</a> <label for=__nav_3_1_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1_1> <span class="md-nav__icon md-icon"></span> July of 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_1> <div class="md-nav__link md-nav__link--index "> <a href=../../newsletter/2022_w30/ >30th Week of 2022</a> <label for=__nav_3_1_1_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_1_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1_1_1> <span class="md-nav__icon md-icon"></span> 30th Week of 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../newsletter/2022_07_29/ class=md-nav__link> 29th July 2022 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_2> <div class="md-nav__link md-nav__link--index "> <a href=../../newsletter/2022_w28/ >28th Week of 2022</a> <label for=__nav_3_1_1_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_1_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1_1_2> <span class="md-nav__icon md-icon"></span> 28th Week of 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../newsletter/2022_07_11/ class=md-nav__link> 11th July 2022 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_3> <div class="md-nav__link md-nav__link--index "> <a href=../../newsletter/2022_w27/ >27th Week of 2022</a> <label for=__nav_3_1_1_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_1_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1_1_3> <span class="md-nav__icon md-icon"></span> 27th Week of 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../newsletter/2022_07_10/ class=md-nav__link> 10th July 2022 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#heading-a2 class=md-nav__link> Heading A2 </a> <nav class=md-nav aria-label="Heading A2"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sub-heading-a2-1 class=md-nav__link> Sub-Heading A2 1 </a> </li> <li class=md-nav__item> <a href=#sub-heading-a2-2 class=md-nav__link> Sub-Heading A2 2 </a> </li> <li class=md-nav__item> <a href=#sub-heading-a2-3 class=md-nav__link> Sub-Heading A2 3 </a> </li> <li class=md-nav__item> <a href=#sub-heading-a2-4 class=md-nav__link> Sub-Heading A2 4 </a> </li> <li class=md-nav__item> <a href=#sub-heading-a2-5 class=md-nav__link> Sub-Heading A2 5 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Heading A2</h1> <h2 id=heading-a2>Heading A2<a class=headerlink href=#heading-a2 title="Permanent link">⚑</a></h2> <h3 id=sub-heading-a2-1>Sub-Heading A2 1<a class=headerlink href=#sub-heading-a2-1 title="Permanent link">⚑</a></h3> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc fringilla volutpat odio, nec iaculis tortor laoreet vitae. Suspendisse dictum nibh nulla, non fringilla sapien mollis sed. Nunc vehicula facilisis tellus, ut tempor massa bibendum sed. Aenean non justo eu nulla luctus aliquam. Nullam eget arcu a urna ultrices volutpat lobortis ut sapien. Fusce vitae dapibus tellus, nec tincidunt metus. Etiam scelerisque orci ac ligula fermentum rhoncus. Ut at nisi quis tellus imperdiet porta. In semper mollis urna, nec ultricies purus bibendum non.</p> <h3 id=sub-heading-a2-2>Sub-Heading A2 2<a class=headerlink href=#sub-heading-a2-2 title="Permanent link">⚑</a></h3> <p>Etiam et sollicitudin dui, at tempor nulla. Suspendisse vitae scelerisque metus. Curabitur efficitur elementum felis id molestie. Proin auctor nulla nec tellus rhoncus, a rhoncus quam volutpat. Integer faucibus nisl et augue tincidunt convallis. Sed aliquet justo vel risus tempus, fringilla ultrices tortor fringilla. Nullam enim metus, commodo eu mi consequat, tincidunt varius nisi. Vestibulum aliquam ipsum ex, vel dignissim nulla sodales vel. In quis iaculis magna, sit amet imperdiet nisl.</p> <h3 id=sub-heading-a2-3>Sub-Heading A2 3<a class=headerlink href=#sub-heading-a2-3 title="Permanent link">⚑</a></h3> <p>Vestibulum nec ultricies odio. Nam ipsum nunc, molestie vitae vehicula eget, fermentum at nulla. Vestibulum porta quam vitae urna tincidunt vehicula. Vivamus varius enim in bibendum maximus. Nam at dolor eget mauris laoreet commodo id eu est. Vestibulum faucibus placerat egestas. Nullam semper dui eget purus lacinia rhoncus. Vestibulum sollicitudin vitae ipsum eget auctor. Vivamus congue lorem gravida mi facilisis, ac gravida erat vulputate. Proin pharetra et nunc quis viverra. Proin dignissim consectetur metus nec eleifend. Nullam vitae ex vel lorem efficitur gravida.</p> <h3 id=sub-heading-a2-4>Sub-Heading A2 4<a class=headerlink href=#sub-heading-a2-4 title="Permanent link">⚑</a></h3> <p>Aliquam convallis libero suscipit metus interdum, non volutpat enim rhoncus. Suspendisse et purus a ex sodales varius in sit amet quam. Aenean vel dui a mi feugiat aliquet in et lacus. Fusce sagittis, nibh eget lobortis tincidunt, leo eros tincidunt est, eu viverra libero purus ac velit. Aliquam vulputate venenatis sem eget vulputate. Integer sed sapien dui. Donec lacinia sed nisi et varius. Phasellus dictum nec justo quis faucibus. Nunc sed elit convallis, scelerisque erat non, tristique nulla. Sed nec maximus lorem, vitae efficitur est. Sed vel augue nisi.</p> <h3 id=sub-heading-a2-5>Sub-Heading A2 5<a class=headerlink href=#sub-heading-a2-5 title="Permanent link">⚑</a></h3> <p>Pellentesque convallis ullamcorper facilisis. Donec quis justo et risus luctus fringilla a ac augue. Nulla imperdiet hendrerit consequat. Fusce ullamcorper ante vel nulla pharetra, vitae fringilla metus tincidunt. Curabitur convallis non odio a tempus. Nulla nec lectus viverra mauris faucibus efficitur quis a lectus. Etiam aliquam neque tellus, eget euismod lorem cursus ac. Pellentesque sagittis, quam in finibus vestibulum, elit nunc aliquet ex, vel ullamcorper ex tortor eget nunc. Quisque vestibulum turpis nec efficitur commodo. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam maximus a lorem et congue. Curabitur orci purus, auctor et porttitor euismod, porttitor in magna. Duis rhoncus sed nunc sed sagittis. In sed mauris nec augue luctus blandit.</p> <div class=highlight><pre><span></span><code><span class=kt>def</span><span class=w> </span><span class=nf>getCruiseControlStatus</span><span class=o>(</span><span class=n>String</span><span class=w> </span><span class=n>webToolsHost</span><span class=o>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>encryptionKey</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>cruise_control_status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;&quot;</span>
<span class=w>    </span><span class=k>try</span><span class=w> </span><span class=o>{</span>
<span class=w>        </span><span class=n>cruise_control_status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sh</span><span class=o>(</span><span class=nl>script:</span><span class=w> </span><span class=s2>&quot;./run_command_on_ec2_instance.sh ${webToolsHost} ${encryptionKey} &#39;curl -s localhost:9104/kafkacruisecontrol/state?json=true | jq .MonitorState.state -r&#39;&quot;</span><span class=o>,</span><span class=w> </span><span class=nl>returnStdout:</span><span class=w> </span><span class=kc>true</span><span class=o>).</span><span class=na>trim</span><span class=o>()</span>
<span class=w>    </span><span class=o>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=o>(</span><span class=n>err</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>        </span><span class=n>cruise_control_status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;FAILED To Retrieve Cruise Control Status, Error: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>err</span>
<span class=w>    </span><span class=o>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>cruise_control_status</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=n>cruise_control_status</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;FAILED to get status of cruise control, server possibly down&quot;</span>
<span class=o>}</span>

<span class=n>node</span><span class=o>(</span><span class=s1>&#39;large&#39;</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>    </span><span class=n>timestamps</span><span class=w> </span><span class=o>{</span>
<span class=w>        </span><span class=n>checkout</span><span class=w> </span><span class=n>scm</span>
<span class=w>        </span><span class=n>utils</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>load</span><span class=w> </span><span class=s1>&#39;./jenkins/groovy_modules/utilities.groovy&#39;</span>
<span class=w>        </span><span class=n>load</span><span class=w> </span><span class=s1>&#39;./jenkins/groovy_modules/global_vars.groovy&#39;</span>

<span class=w>        </span><span class=c1>// load credentials into environment variables</span>
<span class=w>        </span><span class=n>withCredentials</span><span class=o>([</span><span class=n>usernamePassword</span><span class=o>(</span><span class=nl>credentialsId:</span><span class=w> </span><span class=s1>&#39;svc-accnt&#39;</span><span class=o>,</span><span class=w> </span><span class=nl>passwordVariable:</span><span class=w> </span><span class=s1>&#39;ANSIBLE_VAULT_PASSWORD&#39;</span><span class=o>,</span><span class=w> </span><span class=nl>usernameVariable:</span><span class=w> </span><span class=s1>&#39;ANSIBLE_VAULT_USER&#39;</span><span class=o>)])</span><span class=w> </span><span class=o>{</span>
<span class=w>            </span><span class=n>creds</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>utils</span><span class=o>.</span><span class=na>loadCredentials</span><span class=o>()</span>
<span class=w>        </span><span class=o>}</span>

<span class=w>        </span><span class=n>wrap</span><span class=o>([</span><span class=n>$class</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;BuildUser&#39;</span><span class=o>])</span><span class=w> </span><span class=o>{</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=o>(</span><span class=n>env</span><span class=o>.</span><span class=na>BUILD_USER_ID</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>                </span><span class=n>USER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;${BUILD_USER_ID}&quot;</span>
<span class=w>            </span><span class=o>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=o>{</span>
<span class=w>                </span><span class=n>USER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;stp_atlas_wayfinder&quot;</span>
<span class=w>            </span><span class=o>}</span>
<span class=w>        </span><span class=o>}</span>

<span class=w>        </span><span class=n>PR_SAML_ACCOUNT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;${samlAccountPR}&quot;</span>
<span class=w>        </span><span class=n>PR_IAM_ROLE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;${iamRoleArnPRcontrol}&quot;</span>
<span class=w>        </span><span class=n>NP_SAML_ACCOUNT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;${samlAccountNP}&quot;</span>
<span class=w>        </span><span class=n>NP_IAM_ROLE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;${iamRoleArnNP}&quot;</span>

<span class=w>        </span><span class=n>NP_WEB_TOOLS_HOST</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;zk-kafka-web-psup.wayf.emstest.nbn-aws.local&quot;</span>
<span class=w>        </span><span class=n>PROD_WEB_TOOLS_HOST</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;zk-kafka-web-prod.wayf.emsprod.nbn-aws.local&quot;</span>

<span class=w>        </span><span class=n>checkout</span><span class=o>([</span>
<span class=w>                </span><span class=n>$class</span><span class=w>                           </span><span class=o>:</span><span class=w> </span><span class=s1>&#39;GitSCM&#39;</span><span class=o>,</span>
<span class=w>                </span><span class=n>branches</span><span class=w>                         </span><span class=o>:</span><span class=w> </span><span class=o>[[</span><span class=nl>name:</span><span class=w> </span><span class=s1>&#39;master&#39;</span><span class=o>]],</span>
<span class=w>                </span><span class=nl>doGenerateSubmoduleConfigurations:</span><span class=w> </span><span class=kc>false</span><span class=o>,</span>
<span class=w>                </span><span class=n>extensions</span><span class=w>                       </span><span class=o>:</span><span class=w> </span><span class=o>[[</span><span class=n>$class</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;CloneOption&#39;</span><span class=o>,</span><span class=w> </span><span class=nl>noTags:</span><span class=w> </span><span class=kc>false</span><span class=o>,</span><span class=w> </span><span class=nl>reference:</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=o>,</span><span class=w> </span><span class=nl>shallow:</span><span class=w> </span><span class=kc>true</span><span class=o>],</span><span class=w> </span><span class=o>[</span><span class=n>$class</span><span class=o>:</span><span class=w> </span><span class=s1>&#39;RelativeTargetDirectory&#39;</span><span class=o>,</span><span class=w> </span><span class=nl>relativeTargetDir:</span><span class=w> </span><span class=s1>&#39;api-smoketest&#39;</span><span class=o>]],</span>
<span class=w>                </span><span class=n>submoduleCfg</span><span class=w>                     </span><span class=o>:</span><span class=w> </span><span class=o>[],</span>
<span class=w>                </span><span class=n>userRemoteConfigs</span><span class=w>                </span><span class=o>:</span><span class=w> </span><span class=o>[[</span><span class=nl>credentialsId:</span><span class=w> </span><span class=s1>&#39;svc-accnt&#39;</span><span class=o>,</span><span class=w> </span><span class=nl>url:</span><span class=w> </span><span class=s2>&quot;https://git.nbnco.net.au/digital-products/api-smoketest.git&quot;</span><span class=o>]]</span>
<span class=w>        </span><span class=o>])</span>

<span class=w>        </span><span class=n>dirname</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;${env.WORKSPACE}/build-scripts&quot;</span>
<span class=w>        </span><span class=n>dir</span><span class=o>(</span><span class=n>dirname</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>            </span><span class=n>utils</span><span class=o>.</span><span class=na>withSaml2AwsCredentials</span><span class=o>(</span><span class=s1>&#39;aws-creds&#39;</span><span class=o>,</span><span class=w> </span><span class=s2>&quot;$NP_SAML_ACCOUNT&quot;</span><span class=o>,</span><span class=w> </span><span class=s2>&quot;$NP_IAM_ROLE&quot;</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>                </span><span class=n>np_instances_to_patch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sh</span><span class=o>(</span><span class=nl>script:</span><span class=w> </span><span class=s2>&quot;python -u check_instance_ami_patching.py --max-ami-age 14&quot;</span><span class=o>,</span><span class=w> </span><span class=nl>returnStdout:</span><span class=w> </span><span class=kc>true</span><span class=o>).</span><span class=na>trim</span><span class=o>()</span>
<span class=w>                </span><span class=n>np_cruise_control_status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;Non Prod CruiseControl Status from ${NP_WEB_TOOLS_HOST} is: [&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>getCruiseControlStatus</span><span class=o>(</span><span class=n>NP_WEB_TOOLS_HOST</span><span class=o>,</span><span class=w> </span><span class=s2>&quot;encrypted_ec2_key_np&quot;</span><span class=o>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;]&quot;</span>
<span class=w>                </span><span class=n>println</span><span class=w> </span><span class=n>np_instances_to_patch</span>
<span class=w>                </span><span class=n>println</span><span class=w> </span><span class=n>np_cruise_control_status</span>
<span class=w>            </span><span class=o>}</span>
<span class=w>            </span><span class=n>withCredentials</span><span class=o>([</span><span class=n>usernamePassword</span><span class=o>(</span><span class=nl>credentialsId:</span><span class=w> </span><span class=s1>&#39;ado-aws&#39;</span><span class=o>,</span><span class=w> </span><span class=nl>passwordVariable:</span><span class=w> </span><span class=s1>&#39;AWS_PASS&#39;</span><span class=o>,</span><span class=w> </span><span class=nl>usernameVariable:</span><span class=w> </span><span class=s1>&#39;AWS_USER&#39;</span><span class=o>)])</span><span class=w> </span><span class=o>{</span>
<span class=w>                </span><span class=n>utils</span><span class=o>.</span><span class=na>withSaml2AwsCredentials</span><span class=o>(</span><span class=s1>&#39;ado-aws&#39;</span><span class=o>,</span><span class=w> </span><span class=s2>&quot;$PR_SAML_ACCOUNT&quot;</span><span class=o>,</span><span class=w> </span><span class=s2>&quot;$PR_IAM_ROLE&quot;</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>                    </span><span class=n>pr_instances_to_patch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sh</span><span class=o>(</span><span class=nl>script:</span><span class=w> </span><span class=s2>&quot;python -u check_instance_ami_patching.py --max-ami-age 50&quot;</span><span class=o>,</span><span class=w> </span><span class=nl>returnStdout:</span><span class=w> </span><span class=kc>true</span><span class=o>).</span><span class=na>trim</span><span class=o>()</span>
<span class=w>                    </span><span class=n>prod_cruise_control_status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;Production CruiseControl Status from ${PROD_WEB_TOOLS_HOST} is: [&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>getCruiseControlStatus</span><span class=o>(</span><span class=n>PROD_WEB_TOOLS_HOST</span><span class=o>,</span><span class=w> </span><span class=s2>&quot;encrypted_ec2_key_pr&quot;</span><span class=o>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;]&quot;</span>
<span class=w>                    </span><span class=n>println</span><span class=w> </span><span class=n>pr_instances_to_patch</span>
<span class=w>                    </span><span class=n>println</span><span class=w> </span><span class=n>prod_cruise_control_status</span>
<span class=w>                </span><span class=o>}</span>
<span class=w>            </span><span class=o>}</span>

<span class=w>        </span><span class=o>}</span>

<span class=w>        </span><span class=n>dirname</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;${env.WORKSPACE}/api-smoketest&quot;</span>
<span class=w>        </span><span class=n>dir</span><span class=o>(</span><span class=n>dirname</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>            </span><span class=k>try</span><span class=w> </span><span class=o>{</span>
<span class=w>                </span><span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Smoketest NP&#39;</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>                    </span><span class=n>utils</span><span class=o>.</span><span class=na>retry_unreliable</span><span class=o>(</span><span class=mi>3</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>                        </span><span class=n>sh</span><span class=w> </span><span class=s2>&quot;./healthcheck.sh nonprod $NONPROD_RECIPIENTS&quot;</span>
<span class=w>                        </span><span class=n>email_body</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sh</span><span class=o>(</span><span class=nl>script:</span><span class=w> </span><span class=s2>&quot;cat ./logfile.txt&quot;</span><span class=o>,</span><span class=w> </span><span class=nl>returnStdout:</span><span class=w> </span><span class=kc>true</span><span class=o>).</span><span class=na>trim</span><span class=o>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;\n\n\n&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>np_cruise_control_status</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;\n\n\n&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>np_instances_to_patch</span>
<span class=w>                        </span><span class=n>println</span><span class=w> </span><span class=n>email_body</span>
<span class=w>                        </span><span class=n>utils</span><span class=o>.</span><span class=na>emailLogFile</span><span class=o>(</span><span class=n>env</span><span class=o>.</span><span class=na>NONPROD_RECIPIENTS</span><span class=o>,</span><span class=w> </span><span class=n>email_body</span><span class=o>,</span><span class=w> </span><span class=s2>&quot;Atlas Wayfinder Environment Health Check: Non-Production&quot;</span><span class=o>)</span>
<span class=w>                    </span><span class=o>}</span>
<span class=w>                </span><span class=o>}</span>
<span class=w>                </span><span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Smoketest PR&#39;</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>                    </span><span class=n>utils</span><span class=o>.</span><span class=na>retry_unreliable</span><span class=o>(</span><span class=mi>3</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>                        </span><span class=n>sh</span><span class=w> </span><span class=s2>&quot;./healthcheck.sh prod $PROD_RECIPIENTS&quot;</span>
<span class=w>                        </span><span class=n>email_body</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sh</span><span class=o>(</span><span class=nl>script:</span><span class=w> </span><span class=s2>&quot;cat ./logfile.txt&quot;</span><span class=o>,</span><span class=w> </span><span class=nl>returnStdout:</span><span class=w> </span><span class=kc>true</span><span class=o>).</span><span class=na>trim</span><span class=o>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;\n\n\n&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>prod_cruise_control_status</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;\n\n\n&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>pr_instances_to_patch</span>
<span class=w>                        </span><span class=n>utils</span><span class=o>.</span><span class=na>emailLogFile</span><span class=o>(</span><span class=n>env</span><span class=o>.</span><span class=na>PROD_RECIPIENTS</span><span class=o>,</span><span class=w> </span><span class=n>email_body</span><span class=o>,</span><span class=w> </span><span class=s2>&quot;Atlas Wayfinder Environment Health Check: Production&quot;</span><span class=o>)</span>
<span class=w>                    </span><span class=o>}</span>
<span class=w>                </span><span class=o>}</span>
<span class=w>            </span><span class=o>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=o>(</span><span class=n>err</span><span class=o>)</span><span class=w> </span><span class=o>{</span>
<span class=w>                </span><span class=n>utils</span><span class=o>.</span><span class=na>emailOnFailure</span><span class=o>(</span><span class=s2>&quot;$USER@nbnco.com.au&quot;</span><span class=o>)</span>
<span class=w>                </span><span class=k>throw</span><span class=w> </span><span class=n>err</span>
<span class=w>            </span><span class=o>}</span>
<span class=w>        </span><span class=o>}</span>
<span class=w>    </span><span class=o>}</span>
<span class=o>}</span>
</code></pre></div> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2022-07-29T10:51:44+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2022-07-29</span> </small> </div> </article> </div> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/aloconte target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://aloconte.github.io/newsletter/0_newsletter_index target=_blank rel=noopener title=aloconte.github.io class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64zm0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0zm32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.top", "content.code.annotate", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.b425cdc4.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> </body> </html>